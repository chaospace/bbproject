!function(t){var e=function(t){this.dataProvider=t,this.originData=t.concat(),this.skipDataProvider=this.getTileList()},i={CHANGE:"CHANGE"};e.prototype={sortByType:function(e){this.dataProvider=this.originData.concat(),""!=e&&(this.dataProvider=this.dataProvider.filter(function(t){return t.type==e})),this.skipDataProvider=this.getTileList();var o=t.Event(i.CHANGE,{msg:"데이터모델변경"});t(this).trigger(o)},getTileList:function(){var t,e,i=[];for(t=0;t<this.dataProvider.length;t++)e=this.dataProvider[t],i=i.concat(e.items);return i=i.filter(function(t){return"..."!==t.title})},setDataCursor:function(e){var i=this;this.cursorIndex=0,t.each(this.skipDataProvider,function(t,o){o.title===e.title&&(i.cursorIndex=t)})},getNextData:function(){return this.cursorIndex++,this.cursorIndex%=this.skipDataProvider.length,this.skipDataProvider[this.cursorIndex]},getPrevData:function(){return this.cursorIndex--,this.cursorIndex<0&&(this.cursorIndex=this.skipDataProvider.length-1),this.skipDataProvider[this.cursorIndex]}},window.BlockModel=e,window.BlockModelEvent=i}(jQuery),function(t){function e(t,e,i,o){var n={x:0,y:0},s=Math.abs(i.x),r=Math.abs(i.y),a=Math.floor(t/2),h=Math.floor(e/2),l=a-s,c=h-r,p=a-Math.abs(l),d=h-Math.abs(c);return p>d?n.y=c>0?-1:1:n.x=l>0?-1:1,n}var o={ITEM_CLICK:"ITEM_CLICK",ITEM_MOUSE_OVER:"ITEM_MOUSE_OVER",ITEM_MOUSE_OUT:"ITEM_MOUSE_OUT"},n=new Howl({src:["assets/sound/single_oil_can.mp3"],volume:.3}),s=function(t,e){return PIXI.Container.call(this),this.name="",this.ITEM_ID="renderer_",this.TEXTURE_SIZE=e.tileSize/2-e.gap,this.GAP=e.gap,this.COVER_CHILD="cover",this.dataProvider=t,this.rendererPositions={},this.startPosition={x:0,y:0},this.distance=0,this.compose(),this.appendCover(),this};s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.colors="0xffff00,0xfcf800,0xf9ef00,0xf6e800,0xf3e000,0xf0d900,0xedd200,0xeacb00,0xe8c300,0xe5bb00,0xe2b400,0xdfac00,0xdda400,0xda9d01,0xd89502,0xd58d03,0xd38405,0xd17d07,0xcf7309,0xcd6a0c,0xcc6010,0xca5713,0xca4b18,0xc93e1f,0xc92b2a,0xc6113e,0xbc0057,0xaf006b,0xa10079,0x930085,0x553a82,0x4f4582,0x494f82,0x425a82,0x3b6381,0x336a81,0x277381,0x157b80,0x22836f,0x358960,0x439056,0x4e964f,0x599c49,0x63a144,0x6da840,0x76ad3b,0x80b338,0x8ab934,0x93bf30,0x9cc52d,0xa6ca2a,0xb0d126,0xbad722,0xc4dc1f,0xcde21b,0xd6e817,0xe1ed12,0xebf40c,0xf5f906,0xffff00".split(","),s.prototype.appendCover=function(){null==this.cover&&(this.cover=new PIXI.Graphics,this.cover.name=this.COVER_CHILD,this.cover.beginFill(0,1),this.cover.drawRect(this.GAP,this.GAP,this.GAP+2*this.TEXTURE_SIZE,this.GAP+2*this.TEXTURE_SIZE),this.cover.hitArea=new PIXI.Rectangle(0,0,1,1),this.addChild(this.cover))},s.prototype.removeCover=function(){return TweenLite.to(this.cover,1.5,{alpha:0,onStart:function(t){t.startChildrenTransition()},onStartParams:[this],onComplete:function(t){t.removeChild(t.cover),t.cover=null},onCompleteParams:[this]})},s.prototype.startChildrenTransition=function(){for(i=0;i<this.children.length;i++)try{renderer=this.getChildByName(this.ITEM_ID+i),renderer.showInTransition(),this.registRendererEvent(renderer)}catch(t){}},s.prototype.addedTransition=function(){var t=2*this.TEXTURE_SIZE+this.GAP;this.scale.set(0,0),TweenLite.to(this.scale,.3+.1*this.distance,{delay:.09*this.distance,x:1,y:1,ease:Power3.easeOut,onUpdate:function(e){try{e.position.x=e.startPosition.x+Math.floor(.5*(t-t*e.scale.x)),e.position.y=e.startPosition.y+Math.floor(.5*(t-t*e.scale.x))}catch(t){console.log("error",t,e)}},onUpdateParams:[this],onComplete:function(t){null!=t&&t.removeCover()},onCompleteParams:[this]})},s.prototype.killTransition=function(){TweenLite.killTweensOf(this.cover),TweenLite.killTweensOf(this.scale,{x:!0,y:!0}),TweenLite.killTweensOf(this)},s.prototype.prepareRefresh=function(t){this.appendCover(),TweenLite.killTweensOf(this.cover),TweenLite.fromTo(this.cover,.5+.1*this.distance,{alpha:0},{alpha:1,delay:.09*this.distance,onComplete:function(e){e.setDataProvider(t),e.removeCover()},onCompleteParams:[this],ease:Power3.easeOut})},s.prototype.setDataProvider=function(t){this.removeRenderers(),this.dataProvider=t,this.compose()},s.prototype.removeRenderers=function(){for(var t,e=0;e<this.dataProvider.items.length;e++)t=this.getChildByName(this.ITEM_ID+e),t.removeListener("click",t.listeners("click")[0]),t.removeListener("mouseover",t.listeners("mouseover")[0]),t.removeListener("mouseout",t.listeners("mouseout")[0]),t.cleanup(),this.removeChild(t)},s.prototype.compose=function(){var t,e,i,o=0,n=0,s=new PIXI.Point;for(i=0;i<4;i++)o=i%2,n=Math.floor(i/2),s.set(this.GAP+(this.TEXTURE_SIZE+this.GAP)*o,this.GAP+(this.TEXTURE_SIZE+this.GAP)*n),this.rendererPositions[o+"_"+n]=s.clone();for(i=0;i<this.dataProvider.items.length;i++)t=this.dataProvider.items[i],e=new r(this.ITEM_ID+i,t),e.position.x=this.GAP,e.position.y=this.GAP,i>0&&this.validateRendererPosition(e),this.checkInChild(e)},s.prototype.checkInChild=function(t){this.addChild(t);for(var e=Math.floor(t.position.y/this.TEXTURE_SIZE),i=Math.floor(t.position.x/this.TEXTURE_SIZE),o=e+Math.floor(t.vo.texture.h/this.TEXTURE_SIZE),n=i+Math.floor(t.vo.texture.w/this.TEXTURE_SIZE),s=i;s<n;s++)for(var r=e;r<o;r++)null!=this.rendererPositions[s+"_"+r]&&(this.rendererPositions[s+"_"+r]=null)},s.prototype.validateRendererPosition=function(t){var e=this.getChildAt(this.children.length-1);Math.floor((e.position.x+e.vo.texture.w)/this.TEXTURE_SIZE),Math.floor((e.position.y+e.vo.texture.h)/this.TEXTURE_SIZE);for(var i in this.rendererPositions)if(null!=this.rendererPositions[i]){t.position=this.rendererPositions[i].clone();break}},s.prototype.registRendererEvent=function(t){function e(t){s.emit(o.ITEM_CLICK,this)}function i(t){s.emit(o.ITEM_MOUSE_OUT,this,t)}function n(t){s.emit(o.ITEM_MOUSE_OVER,this,t)}var s=this;t.interactive=!0,t.on("mouseover",n).on("mouseout",i).on("click",e)},s.prototype.cleanup=function(){this.killTransition(),null!=this.getChildByName(this.DUMMY_CHILD)&&this.removeChild(this.dummy),this.removeRenderers(),this.removeListener(o.ITEM_CLICK,this.listeners(o.ITEM_CLICK)[0]),this.removeListener(o.ITEM_MOUSE_OUT,this.listeners(o.ITEM_MOUSE_OUT)[0]),this.removeListener(o.ITEM_MOUSE_OVER,this.listeners(o.ITEM_MOUSE_OVER)[0]),this.dataProvider=null,this.destroy()};var r=function(t,e){return PIXI.Container.call(this),this.vo=e,this.name=t,this.THUMB_NAIL_ID="thumbNail",this.BACKGROUND_ID="background",this.LABEL_ID="label",this.MASK_ID="mask",this.LABEL_BG_HEIGHT=70,this.COVER_GRAPHICS="coverGraphics",this.compose(),this};r.prototype=Object.create(PIXI.Container.prototype),r.prototype.constructor=r,r.prototype.containsPoint=function(t){return t.x>=this.position.x&&t.x<=this.position.x+this.vo.texture.w&&t.y>=this.position.y&&t.y<=this.position.y+this.vo.texture.h},r.prototype.hasDetailContent=function(){return""!=this.vo.contents.description},r.prototype.hasLink=function(){return""!=this.vo.contents.link},r.prototype.getCoverTexture=function(){var t=s.colors.shift();s.colors.push(t);var e=new PIXI.Graphics;return e.beginFill(t,1),e.drawRect(0,0,this.vo.texture.w,this.vo.texture.h),e.name=this.COVER_GRAPHICS,e},r.prototype.compose=function(){var t=this.vo.texture.w,e=this.vo.texture.h,i=this.hasDetailContent()?new PIXI.Texture.fromImage(this.vo.texture.path):textures[t+"x"+e].texture,o=new PIXI.Sprite(i,new PIXI.Rectangle(0,0,t,e));o.name=this.THUMB_NAIL_ID,o.anchor.set(.5),o.position.set(t/2,e/2);var n=new PIXI.Graphics;n.name=this.MASK_ID,n.beginFill(16763904,1),n.drawRect(0,0,t,e);var s=new PIXI.Graphics;s.name=this.BACKGROUND_ID,s.beginFill(0,1),s.alpha=.8,s.drawRect(0,0,t,e);var r={fontFamily:"Nanum Gothic",fontSize:"16px",fontWeight:"bold",fill:"#ffffff"},a=new PIXI.Text(this.vo.title,r);a.anchor.set(.5),a.height=.5*s.height,a.scale.y=a.scale.x,a.position.x=.5*t,a.position.y=Math.floor(s.position.y+.5*this.LABEL_BG_HEIGHT),a.name=this.LABEL_ID;var h=this.getCoverTexture();this.addChild(o),this.addChild(s),this.addChild(a),this.addChild(h),this.addChild(n),this.mask=n,this.mask.anchorX=0,this.mask.anchorY=0,Math.random()>.5?(this.mask.anchorX=Math.random()>.5?0:-1,this.mask.width=0):(this.mask.anchorY=Math.random()>.5?0:-1,this.mask.height=0)},r.prototype.showInTransition=function(){var t=this;TweenLite.to(this.mask,.5,{width:this.vo.texture.w,height:this.vo.texture.h,onUpdate:function(e){null!=e&&(0!=e.anchorX&&(e.x=t.vo.texture.w+e.anchorX*e.width),0!=e.anchorY&&(e.y=t.vo.texture.h+e.anchorY*e.height))},onUpdateParams:[this.mask],ease:Power3.easeOut})},r.prototype.getCenter=function(){return{x:Math.floor(this.vo.texture.w/2),y:Math.floor(this.vo.texture.h/2)}},r.prototype.focusInTransition=function(t){this.killTransition();var i=this.getChildByName(this.LABEL_ID),o=this.getChildByName(this.THUMB_NAIL_ID),s=this.getChildByName(this.BACKGROUND_ID),r=this.getChildByName(this.COVER_GRAPHICS),a=this.vo.texture.w,h=this.vo.texture.h,l=h/388*.6,c=e(a,h,t);0!=c.x?TweenLite.fromTo(s,l,{x:a*c.x,y:0},{x:0,ease:Power3.easeOut}):0!=c.y&&TweenLite.fromTo(s,l,{y:h*c.y,x:0},{y:0,ease:Power3.easeOut}),TweenLite.to(o.scale,.8,{x:1.2,y:1.2,ease:Back.easeOut}),i.tint=16763904;var p=Math.floor(h/2),d=Math.floor(a/2);TweenLite.fromTo(i,.5,{x:d-d/2*c.x,y:p-p/2*c.y},{x:d,y:p}),TweenLite.to(r,.5,{alpha:0}),n.play()},r.prototype.focusOutTransition=function(t){this.killTransition();var i=this.getChildByName(this.LABEL_ID),o=this.getChildByName(this.THUMB_NAIL_ID),n=this.getChildByName(this.BACKGROUND_ID),s=this.getChildByName(this.COVER_GRAPHICS),r=this.vo.texture.w,a=this.vo.texture.h,h=e(r,a,t);0!=h.x?TweenLite.to(n,.5,{x:r*h.x,y:0}):0!=h.y&&TweenLite.to(n,.5,{y:a*h.y,x:0}),TweenLite.to(o.scale,.5,{x:1,y:1}),i.tint=16777215;var l=Math.floor(a/2),c=Math.floor(r/2);TweenLite.to(i,.5,{x:c-c/2*h.x,y:l-l/2*h.y}),TweenLite.to(s,.5,{alpha:1})},r.prototype.killTransition=function(){var t=this.getChildByName(this.LABEL_ID),e=this.getChildByName(this.THUMB_NAIL_ID),i=this.getChildByName(this.BACKGROUND_ID),o=this.getChildByName(this.COVER_GRAPHICS);TweenLite.killTweensOf(t),TweenLite.killTweensOf(e),TweenLite.killTweensOf(i),TweenLite.killTweensOf(o)},r.prototype.cleanup=function(){var t=this.getChildByName(this.LABEL_ID),e=this.getChildByName(this.THUMB_NAIL_ID),i=this.getChildByName(this.BACKGROUND_ID),o=this.getChildByName(this.MASK_ID),n=this.getChildByName(this.COVER_GRAPHICS);TweenLite.killTweensOf(o),this.removeChild(e),this.removeChild(i),this.removeChild(t),this.removeChild(o),this.removeChild(n),this.destroy()},window.BlockContainer=s,window.BlockItemRenderer=r,window.BlockContainerEvent=o}(jQuery),function(t){function e(t){for(var e=t.split("."),i=window||this,o=0,n=e.length;o<n;o++)i=i[e[o]];if("function"!=typeof i)throw new Error("function not found");return i}function i(t,e){if(t>0)return{max:t+1,min:t-e};var i=t;return{max:i+(e+1),min:i}}var o=function(e){PIXI.Container.call(this),this.gap=0,this.blockSize=0,this.mapArea=null,this.onAddedRenderer=null,this.onRemoveRenderer=null,e=t.extend({gap:6,blockSize:394},e);for(prop in e)this[prop]=e[prop];return this};o.prototype=Object.create(PIXI.Container.prototype),o.prototype.constructor=o,o.prototype.setItemRenderer=function(t){this.itemRendererRef=t},o.prototype.setDataProvider=function(t){this.dataProvider=t,this.blocks={},this.calibrationTileColAndRow("0_0")},o.prototype.getDataFromTilePosition=function(t,e){var i=this.dataProvider.shift();return this.dataProvider.push(i),i},o.prototype.createItemRendererByName=function(t){var i=this.getColAndRowFromName(t),o=parseInt(i[0]),n=parseInt(i[1]),s=e(this.itemRendererRef),r=this.getDataFromTilePosition(o,n),a=new s(r,{tileSize:this.blockSize,gap:this.gap});a.name=t;var h,l,c={x:(this.mapArea.left+this.mapArea.right)/2,y:(this.mapArea.top+this.mapArea.bottom)/2},p=this.toLocal(c),d=Math.sqrt(c.x*c.x+c.y*c.y);return a.startPosition.x=a.position.x=this.blockSize*o,a.startPosition.y=a.position.y=this.blockSize*n,h=Math.floor(p.x-(a.position.x+this.blockSize/2)),l=Math.floor(p.y-(a.position.y+this.blockSize/2)),a.distance=Math.sqrt(h*h+l*l)/d,a},o.prototype.appendRenderer=function(t){this.blocks[t.name]=t,this.addChild(t),null!=this.onAddedRenderer&&this.onAddedRenderer.apply(null,[t])},o.prototype.getColAndRowFromName=function(t){return t.split("_")},o.prototype.calibrationTileColAndRow=function(t){for(var e,o=this.getColAndRowFromName(t),n=parseInt(o[0]),s=parseInt(o[1]),r="",a=i(n,this.cols),h=i(s,this.rows),l=h.min;l<h.max;l++)for(var c=a.min;c<a.max;c++)r=c+"_"+l,null==this.getChildByName(r)&&(e=this.createItemRendererByName(r),this.appendRenderer(e))},o.prototype.hitTestObject=function(t){if(null==this.mapArea)throw new Error("타일 맵 영역 정보를 지정해 줘야 합니다.");var e=this.toGlobal(t.position),i=Math.floor(e.x),o=Math.floor(e.y);return!(i+this.blockSize<this.mapArea.left||i>this.mapArea.right||o+this.blockSize<this.mapArea.top||o>this.mapArea.bottom)},o.prototype.invalidateOutBoundTile=function(){var t;this.children.length-1;for(var e in this.blocks)t=this.blocks[e],t&&(this.hitTestObject(t)||this.removeRendererByName(t.name))},o.prototype.calibrationTileMap=function(){var t=this.position.x/this.blockSize,e=this.position.y/this.blockSize,i=t>0?Math.ceil(t):Math.floor(t),o=e>0?Math.ceil(e):Math.floor(e),n=i+"_"+o;i*=-1,o*=-1,0!=o&&(o>0&&(o=this.rows-1+o),n=i+"_"+o),0!=i&&(i>0&&(i=this.cols-1+i),n=i+"_"+o),this.calibrationTileColAndRow(n)},o.prototype.removeRendererByName=function(t){var e=this.blocks[t];e.cleanup(),this.removeChild(e),null!=this.onRemoveRenderer&&this.onRemoveRenderer.apply(null,[e]),this.blocks[t]=null},o.prototype.getBlockSize=function(){var t=this.getDisplayRoot();return t.scale.x*this.blockSize},o.prototype.getDisplayRoot=function(){for(var t=this.parent;t.parent;)t=t.parent;return t},o.prototype.refreshTileByType=function(t){this.dataProvider=t;for(var e,i=0;i<this.children.length;i++)e=this.children[i],e.prepareRefresh(this.getDataFromTilePosition())},window.BlockTileListView=o}(jQuery),function(t,e){void 0===e&&alert("undefined niceScroll");var i={LOAD_COMPLETE:"LOAD_COMPLETE",CLOSE_CONTENTS:"CLOSE_CONTENTS",REQUEST_NEXT_CONTENT:"REQUEST_NEXT_CONTENT",REQUEST_PREV_CONTENT:"REQUEST_PREV_CONTENT"},o=function(t,e){return this.ele=t,this.initialize()};o.prototype={ele:null,wrapper:null,section:null,buttonSkipLeft:null,buttonSkipRight:null,launchButtonClassID:"page-ani-button",blockEffectClassID:"block-effect",blockEffectOnClassID:"block-effect-on",blockEffectOffClassID:"block-effect-off",initialize:function(){return this.wrapper=t(".wrapper",this.ele),this.section=t(".section",this.ele),this.buttonSkipLeft=t(".left",this.ele),this.buttonSkipRight=t(".right",this.ele),TweenLite.set(this.buttonSkipLeft,{x:60}),TweenLite.set(this.buttonSkipRight,{x:-60}),this},setContentsData:function(e){function o(e){if(c++,c==l.thumbnails.length){var o=t.Event(i.LOAD_COMPLETE,{msg:"로드 완료"});t(T).trigger(o),T.registSkipEvent()}}var n,s,r=this.blockEffectClassID,a=t("<h1/>",{text:e.title}),h=t("<ul/>"),l=e.contents,c=0;this.section.empty(),t(l.thumbnails).each(function(e,i){n=t("<img/>",{src:i}),n.one("load",o),s=t("<li/>").append(n),h.append(s)});var p=t("<p/>"),d=l.description.split("<br/>");t(d).each(function(e,i){p.append(t("<span/>",{text:i,class:r})),e<d.length-1&&p.append("<br/>")});var u=t("<p/>").html('<span class="'+r+'"><strong>제작일 : </strong>'+l.date+"</span>"),f=t("<p/>").html('<span class="'+r+'"><strong>사용 언어 : </strong>'+l.language+"</span>");if(this.section.append(a).append(u).append(f).append(p),l.implements&&l.implements.length>=1){var v=t("<p/>");v.append('<span class="'+r+'"><strong>구현내용</strong></span><br/>');var C=l.implements;t(C).each(function(e,i){v.append(t("<span/>",{text:"- "+i,class:r})),e<C.length-1&&v.append("<br/>")}),this.section.append(v)}if(l.link.length>1){var m=t("<a/>",{class:this.launchButtonClassID,href:l.link,text:"launch",target:"_blank"});TweenLite.set(m,{autoAlpha:0}),this.section.append(m)}l.thumbnails.length>=1&&(TweenLite.set(h,{autoAlpha:0}),this.section.append(h));var c=0,T=this},registSkipEvent:function(){var e=this;this.buttonSkipLeft.on("click",function(o){var n=t.Event(i.REQUEST_PREV_CONTENT,{msg:"이전 데이터 요청"});return t(e).trigger(n),!1}),this.buttonSkipRight.on("click",function(o){var n=t.Event(i.REQUEST_NEXT_CONTENT,{msg:"다음 데이터 요청"});return t(e).trigger(n),!1})},removeSkipEvent:function(){this.buttonSkipLeft.off("click"),this.buttonSkipRight.off("click")},hideContentsData:function(e){var i=(t("<p>",this.section),t("<ul>",this.section),t("."+this.launchButtonClassID,this.section)),o=this,n=0;i&&TweenLite.to(i,.2,{autoAlpha:0,onComplete:function(){i.remove()}}),t(t("."+this.blockEffectClassID,this.section).get().reverse()).each(function(e,i){t(i).removeClass(o.blockEffectOnClassID),TweenLite.set(i,{css:{className:"+="+o.blockEffectOffClassID},delay:n}),n+=.05}),t("ul",o.section)&&TweenLite.to(t("ul",o.section),.2,{autoAlpha:0,delay:n,onComplete:e})},updateContentFromData:function(t){var e=this;this.hideContentsData(function(){e.setContentsData(t)})},focusInTransition:function(){function e(){var e=t.Event(i.CLOSE_CONTENTS,{msg:"컨텐츠 닫기"});t(n).trigger(e)}var o=t(window).height(),n=this;TweenLite.fromTo(this.wrapper,.6,{height:o+"px"},{autoAlpha:1,onStart:function(){n.wrapper.show().niceScroll({cursorwidth:3,cursorborder:"0",hidecursordelay:300}),t(".close-button",n.wrapper).one("click",function(t){e()}),t(".dim-bg",n.ele).one("click",function(t){e()}),n.ele.show()},onComplete:function(){n.resize();var e=.05;t("."+n.blockEffectClassID,n.section).each(function(t,i){TweenLite.set(i,{css:{className:"+="+n.blockEffectOnClassID},delay:e}),e+=.05}),t(".page-ani-button",n.section)&&TweenLite.set(t(".page-ani-button",n.section),{autoAlpha:1,delay:e}),t("ul",n.section)&&TweenLite.to(t("ul",n.section),.3,{autoAlpha:1,delay:e}),TweenLite.to([n.buttonSkipLeft,n.buttonSkipRight],.3,{x:0,autoAlpha:1})},ease:Power3.easeOut})},focusOutTransition:function(){var t=this;TweenLite.to(t.buttonSkipLeft,.2,{x:60,autoAlpha:0}),TweenLite.to(t.buttonSkipRight,.2,{x:-60,autoAlpha:0}),TweenLite.to(this.wrapper,.3,{autoAlpha:0,dleay:.4,onComplete:function(){t.wrapper.scrollTop(0).hide().getNiceScroll().remove(),t.ele.hide(),t.section.empty()}})},isVisible:function(){return this.ele.is(":visible")},resize:function(){var e=t(window).height();this.wrapper.css({height:e+"px"}).getNiceScroll().resize()}},window.ContentsViewEvent=i,window.ContentsViewer=o}(jQuery,jQuery.nicescroll),function(t){function e(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1}var i={OPEN_DETAIL_VIEW:"OPEN_DETAIL_VIEW",VIEW_MOUSE_DOWN:"VIEW_MOUSE_DOWN"},o=new Howl({src:["assets/sound/eff.mp3"],volume:.3}),n=function(){return PIXI.Container.call(this),this.dragging=!1,this.startPoint=null,this.dragPoint=null,this.hasZoom=!1,this.selectItem=null,this.hasIntro=!0,this.useSkip=!1,this.useAddBlockSound=!1,this.ZOOM_SCALE=1.2,this.compose({gap:6,blockSize:191}),this.initializeRender(),this};n.prototype=Object.create(PIXI.Container.prototype),n.prototype.constructor=n,n.prototype.initPosition=function(){var t=this;this.useSkip=!0,TweenLite.to(this.blockListContainer.position,1,{x:0,y:0,onUpdate:function(){t.blockListContainer.calibrationTileMap(),t.blockListContainer.invalidateOutBoundTile()},onComplete:function(){t.useSkip=!1}})},n.prototype.setModel=function(e){this.setDataProvider(e.dataProvider);var i=this;t(e).on(BlockModelEvent.CHANGE,function(){i.blockListContainer.refreshTileByType(e.dataProvider)})},n.prototype.setDataProvider=function(t){this.blockListContainer.setDataProvider(t),this.resize(),this.useAddBlockSound=!0,this.hasIntro=!0},n.prototype.composeIntroAnimation=function(){for(var t,e=new TimelineMax,i=0;i<this.blockListContainer.children.length;i++)t=this.blockListContainer.children[i],e.add(t.removeCover(),"-=1");return e.timeScale(2),this.hasIntro=!1,e},n.prototype.compose=function(n){var s=this.getStageSize(),r=n.gap,a=n.blockSize,h=2*(r+a);this.blockListContainer=new BlockTileListView({cols:Math.ceil(s.w/h),rows:Math.ceil(s.w/h),blockSize:h,gap:r,mapArea:{left:0,top:0,right:s.w,bottom:s.h}});var l=this;this.blockListContainer.setItemRenderer("BlockContainer"),this.blockListContainer.onAddedRenderer=function(n){if(n.on(BlockContainerEvent.ITEM_CLICK,function(e){var o=!l.startPoint.equals(l.blockListContainer.position);if(!o&&e.hasDetailContent()){var n=t.Event(i.OPEN_DETAIL_VIEW,{msg:"상세보기요청",vo:e.vo});t(l).trigger(n)}}).on(BlockContainerEvent.ITEM_MOUSE_OVER,function(t,e){if(!l.dragging){var i=e.data.getLocalPosition(t);t.focusInTransition(i)}}).on(BlockContainerEvent.ITEM_MOUSE_OUT,function(t,e){var i=e.data.getLocalPosition(t);t.focusOutTransition(i)}),!l.hasIntro)if(l.useSkip)n.removeCover();else{if(e()&&l.useAddBlockSound){var s=o.play();null!=s&&o.fade(0,.5,200,s)}n.addedTransition()}},this.scaleContainer=new PIXI.Container,this.detailBGContainer=new PIXI.Container,this.detailBG=new PIXI.Graphics,this.detailBGContainer.addChild(this.detailBG),this.detailBGContainer.visible=!1,this.detailBGContainer.interactive=!1,this.scaleContainer.addChild(this.blockListContainer),this.addChild(this.scaleContainer),this.addChild(this.detailBGContainer)},n.prototype.registEventListener=function(){this.blockListContainer.interactive=!0,this.blockListContainer.buttonMode=!0,this.blockListContainer.on("mousedown",this.onMouseDownContainer.bind(this))},n.prototype.registMouseMoveEventListener=function(){this.blockListContainer.on("mousemove",this.onMouseMoveContainer.bind(this)).on("mouseup",this.onMouseUpContainer.bind(this)).on("mouseupoutside",this.onMouseUpContainer.bind(this))},n.prototype.removeMouseMoveEventListener=function(){this.blockListContainer.removeListener("mousemove",this.blockListContainer.listeners[0]).removeListener("mouseup",this.blockListContainer.listeners[0]).removeListener("mouseupoutside",this.blockListContainer.listeners[0])},n.prototype.onMouseMoveContainer=function(t){if(this.dragging){var e=t.data.global;if(this.blockListContainer.position.x=this.startPoint.x+(e.x-this.dragPoint.x),this.blockListContainer.position.y=this.startPoint.y+(e.y-this.dragPoint.y),this.hasZoom&&this.blockListContainer.calibrationTileMap(),!this.hasZoom&&!this.startPoint.equals(this.blockListContainer.position)){this.selectItem&&this.initMouseOverBlockContainer(this.selectItem,t),this.hasZoom=!0;this.getStageSize();TweenLite.to(this.scaleContainer.scale,1,{x:this.ZOOM_SCALE,y:this.ZOOM_SCALE,onUpdate:this.updateScaleContainerPoisition.bind(this),ease:Power1.easeOut})}}},n.prototype.onMouseUpContainer=function(t){var e=this;this.dragging=!1,this.selectItem=null,this.hasZoom&&(this.hasZoom=!1,TweenLite.to(this.scaleContainer.scale,.5,{x:1,y:1,onUpdate:this.updateScaleContainerPoisition.bind(this),onComplete:function(){e.blockListContainer.invalidateOutBoundTile()},ease:Power1.easeOut})),this.removeMouseMoveEventListener()},n.prototype.onMouseDownContainer=function(e){this.dragging=!0,this.dragPoint=e.data.global.clone(),this.startPoint=new PIXI.Point(this.blockListContainer.position.x,this.blockListContainer.position.y);var o=e.data.getLocalPosition(this.scaleContainer);o.x-=this.startPoint.x,o.y-=this.startPoint.y;var n=Math.floor(o.x/this.blockListContainer.blockSize),s=Math.floor(o.y/this.blockListContainer.blockSize);this.selectItem=this.blockListContainer.getChildByName(n+"_"+s);var r=t.Event(i.VIEW_MOUSE_DOWN,{msg:"메인뷰클릭",originalEvent:e.data.originalEvent});t(this).trigger(r),this.registMouseMoveEventListener()},n.prototype.updateScaleContainerPoisition=function(){var t=this.getStageSize();this.scaleContainer.position.set(Math.floor(.5*(t.w-t.x*this.scaleContainer.scale.x)),Math.floor(.5*(t.h-t.y*this.scaleContainer.scale.y)))},n.prototype.initMouseOverBlockContainer=function(t,e){if(t instanceof BlockContainer)for(var i=0;i<t.children.length;i++){var o=t.children[i];if(o instanceof BlockItemRenderer){var n=e.data.getLocalPosition(o);o.focusOutTransition(n),this.selectItem=null}}},n.prototype.initializeRender=function(){var t=this.getStageSize();this.renderer=new PIXI.autoDetectRenderer(t.w,t.h,{backgroundColor:16777215,view:document.querySelector("#viewport"),resolution:1}),this.renderer.autoResize=!0},n.prototype.startRender=function(){var t=new PIXI.ticker.Ticker,e=this;t.add(function(t){e.renderer.render(e)}),t.start(),this.registEventListener()},n.prototype.updateDetailBG=function(){var t=this.getStageSize();this.detailBG.clear(),this.detailBG.beginFill(0,.9),this.detailBG.drawRect(0,0,t.w,t.h),this.detailBG.endFill()},n.prototype.resize=function(){var t=this.getStageSize(),e=this.blockListContainer.blockSize;this.renderer.view.style.width=t.w+"px",this.renderer.view.style.height=t.h+"px",this.renderer.resize(t.w,t.h),this.blockListContainer.cols=Math.ceil(t.w/e),this.blockListContainer.rows=Math.ceil(t.h/e),this.blockListContainer.mapArea={left:0,right:t.w,top:0,bottom:t.h},this.blockListContainer.calibrationTileMap(),console.log("resize-aaa"),this.updateDetailBG()},n.prototype.contentFocusInTransition=function(t){var e=this.getStageSize();this.detailBGContainer.visible=!0,TweenLite.fromTo(this.detailBGContainer,.6,{y:e.h},{y:0,onComplete:t,ease:Power3.easeOut})},n.prototype.contentFocusOutTransition=function(){var t=this,e=this.getStageSize();TweenLite.to(this.detailBGContainer,.5,{y:-e.h,onComplete:function(){t.detailBGContainer.visible=!1},ease:Power3.easeOut})},n.prototype.getStageSize=function(){return{w:t(window).width(),h:t(window).height()}},window.PixiViewEvent=i,window.PixiViewContainer=n}(jQuery);